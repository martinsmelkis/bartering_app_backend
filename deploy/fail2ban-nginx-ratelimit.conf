# Fail2Ban Filter for Nginx Rate Limiting
# Place this file in /etc/fail2ban/filter.d/nginx-ratelimit.conf
#
# This filter detects when nginx rate limiting is triggered
# and automatically bans IPs that repeatedly hit rate limits

[Definition]

# Match nginx error log entries for rate limiting violations
# Covers both limit_req and limit_conn violations
failregex = limiting requests, excess:.* by zone.*client: <HOST>
            limiting connections by zone.*client: <HOST>
            limiting requests.*client: <HOST>

# Ignore legitimate traffic patterns
ignoreregex =
